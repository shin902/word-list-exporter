# My 暗記帳

フラッシュカード形式で学習できるWebアプリケーション

## 使い方

1. `index.html` をブラウザで開く
2. 「設定」からGemini API Keyを設定（画像インポート機能を使う場合）
3. 「一覧表示」→「追加」から単語カードを手動登録、または「インポート」から画像をアップロード
4. 「学習開始」でランダムに出題される問題を学習

## 機能

- ✅ ホーム画面
- ✅ 単語カード追加機能
- ✅ 単語カード一覧表示（カテゴリ別）
- ✅ 単語カード削除機能
- ✅ ランダム出題による学習モード
- ✅ 上付き・下付き文字サポート（例: `x^2`, `H_2O`）
- ✅ ローカルストレージでのデータ永続化
- ✅ 画像からの赤字抽出インポート機能（Gemini Vision API使用）

## 画像インポート機能のセットアップ

画像から単語カードをインポートする機能を使うには、Gemini API Keyが必要です。

### 1. Gemini API Keyの取得

1. [Google AI Studio](https://aistudio.google.com/app/apikey) にアクセス
2. Googleアカウントでログイン
3. 「Create API Key」をクリックしてAPI Keyを生成
4. 生成されたAPI Key（`AIza`で始まる39文字の文字列）をコピー

### 2. API Keyの設定

1. アプリのホーム画面で「設定」ボタンをクリック
2. Gemini API Keyの入力欄に取得したAPI Keyを貼り付け
3. 「保存」ボタンをクリック

#### API Keyの削除

不要になった場合や共有PCで使用した後は、以下の手順でAPI Keyを削除できます：

1. 設定画面で「API Keyをクリア」ボタンをクリック
2. 確認ダイアログで「OK」をクリック
3. API Keyがローカルストレージから完全に削除されます
4. 必要に応じて [Google AI Studio](https://aistudio.google.com/app/apikey) でAPI Keyを無効化してください

### 3. 画像のインポート

1. 「一覧表示」→「インポート」をクリック
2. カテゴリ名を入力（デフォルトは「英単語」）
3. 赤字が含まれる画像を選択
4. 「赤字を抽出してインポート」ボタンをクリック
5. 認識されたカードを確認・編集して保存

### セキュリティに関する注意事項

⚠️ **重要**: API Keyはブラウザのローカルストレージに保存されます。以下の点に注意してください：

#### API Key保存に関するリスク

このアプリケーションはクライアントサイドのみで動作するため、API KeyをブラウザのlocalStorageに保存します。これには以下のセキュリティリスクがあります：

- **XSS攻撃への脆弱性**: 悪意のあるスクリプトがlocalStorageにアクセスできる可能性があります（本アプリは対策済みですが、完全ではありません）
- **物理的アクセス**: デバイスにアクセスできる第三者がブラウザの開発者ツールからAPI Keyを読み取れます
- **暗号化なし**: API KeyはlocalStorageに平文で保存されます
- **ブラウザ拡張機能**: 悪意のあるブラウザ拡張機能がlocalStorageにアクセスできる可能性があります

#### セキュリティのベストプラクティス

1. **個人のデバイスでのみ使用**: 共有PCや公共のPCでは使用しないでください
2. **信頼できるデバイスのみ**: 信頼できるデバイスでのみAPI Keyを保存してください
3. **API Keyを共有しない**: API Keyを他人と共有しないでください
4. **使用後は削除**: 不要になったらAPI Keyを削除し、Google AI Studioで無効化してください
5. **定期的なローテーション**: セキュリティのため、定期的にAPI Keyを再生成することを推奨します
6. **ブラウザ拡張機能に注意**: 信頼できないブラウザ拡張機能をインストールしないでください

#### より安全な代替案（上級者向け）

本格的に使用する場合は、以下の方法を検討してください：

- **バックエンドプロキシの実装**: サーバーサイドでAPI Keyを管理し、クライアントからはプロキシ経由でAPIを呼び出す
- **環境変数の使用**: ローカル開発環境で環境変数を使用してAPI Keyを管理する
- **レート制限の実装**: API Keyの不正利用を防ぐためのレート制限機能を追加する

**⚠️ このアプリケーションは教育目的および個人利用を想定しています。本番環境や機密情報を扱う用途では使用しないでください。**

### API使用料金について

Gemini APIには無料枠があります：
- Gemini 1.5 Flash: 1日あたり1,500リクエストまで無料
- 詳細は [Google AI Pricing](https://ai.google.dev/pricing) を参照

本アプリは画像1枚につき1リクエストを使用します。

### トラブルシューティング

画像インポート時にエラーが発生した場合：

**「API Keyが無効です」エラー**
- 設定画面でAPI Keyが正しく入力されているか確認してください
- Google AI StudioでAPI Keyが有効になっているか確認してください

**「APIのリクエスト上限に達しました」エラー**
- 1日のリクエスト数が上限（1,500回）に達しています
- 翌日まで待つか、Google AI Studioで有料プランを検討してください

**「赤字のテキストが見つかりませんでした」エラー**
- 画像に赤字が含まれているか確認してください
- 画像の解像度が十分か確認してください（推奨: 最低でも800x600以上）

**「Gemini APIからのレスポンスの解析に失敗しました」エラー**
- インターネット接続を確認してください
- しばらく時間をおいてから再度お試しください

## データ形式

```javascript
{
  id: String,        // ユニークID（自動生成）
  category: String,  // カテゴリ名
  question: String,  // 問題文
  answer: String     // 解答文
}
```

## テスト

このプロジェクトには基本的なユニットテストが含まれています。

### テストのセットアップ

```bash
# 依存関係のインストール
npm install

# テストの実行
npm test

# カバレッジレポートの生成
npm run test:coverage
```

詳細については [tests/README.md](tests/README.md) を参照してください。

## 詳細仕様

詳細な仕様については [docs/wordlist-specification.md](docs/wordlist-specification.md) を参照してください。
